<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RokuDoro</title>
    
    <meta property="og:title" content="RokuDoro">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rokudoro.netlify.app">
    <meta property="og:image" content="https://rokudoro.netlify.app/„Ç´„Éº„Éâ_rokudoro.jpg">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="icon" href="„Éï„Ç°„Éì„Ç≥„É≥_tip.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg: #000; --panel: #0a0a0a; --border: #222; --text-main: #fff; --text-dim: #777; --accent: #fff; }
        
        body { background-color: var(--bg); color: var(--text-main); font-family: 'Share Tech Mono', monospace; margin: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; box-sizing: border-box; }
        .pixel-font { font-family: 'Share Tech Mono', monospace; font-weight: 400; }

        .main-layout { display: flex; gap: 20px; align-items: stretch; height: 780px; max-width: 1250px; margin-bottom: 30px; }
        
        .left-side { width: 350px; display: flex; flex-direction: column; gap: 20px; flex-shrink: 0; }
        .timer-side { width: 400px; display: flex; flex-direction: column; gap: 20px; flex-shrink: 0; }
        .right-side { width: 350px; display: flex; flex-direction: column; gap: 20px; flex-shrink: 0; }

        @media (max-width: 1000px) {
            .main-layout { flex-direction: column; height: auto; align-items: center; width: 100%; }
            .timer-side { order: 1; width: 100%; max-width: 500px; }
            .right-side { order: 2; width: 100%; max-width: 500px; }
            .left-side { order: 3; width: 100%; max-width: 500px; }
        }

        .panel { background: var(--panel); border: 1px solid var(--border); border-radius: 40px; padding: 30px; position: relative; box-shadow: 0 20px 50px rgba(0,0,0,0.8); overflow: hidden; }
        
        /* ÊôÇË®à„Çª„ÇØ„Ç∑„Éß„É≥ÔºöÊîπË°åÈò≤Ê≠¢„Å®„Çµ„Ç§„Ç∫Ë™øÊï¥ */
        .clock-card { padding: 15px 20px; display: flex; flex-direction: row; align-items: baseline; justify-content: center; border-radius: 24px; gap: 12px; flex-shrink: 0; white-space: nowrap; }
        .clock-date { font-size: 22px; color: var(--text-main); letter-spacing: 1px; }
        .clock-time { font-size: 22px; color: var(--text-main); }
        
        .notes-panel { height: 40%; display: flex; flex-direction: column; border-radius: 32px; }
        .todo-panel { height: 60%; display: flex; flex-direction: column; border-radius: 32px; }
        
        .timer-container { text-align: center; margin: 10px 0 10px 0; }
        .timer-display { font-size: 80px; line-height: 1; letter-spacing: -2px; }
        .status-tag { font-size: 22px; margin-top: 4px; }
        .set-display { font-size: 18px; margin-top: 4px; color: var(--text-dim); }

        .label { font-size: 10px; color: var(--text-dim); letter-spacing: 3px; text-transform: uppercase; font-weight: 900; display: block; margin-bottom: 8px; }
        
        .controls { display: grid; grid-template-columns: 1fr 1.5fr 1fr; gap: 10px; margin-bottom: 0; padding-bottom: 5px; }
        .btn-icon { background: transparent; border: 1px solid var(--border); border-radius: 16px; padding: 12px; cursor: pointer; color: var(--accent); display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .btn-icon svg { width: 18px; height: 18px; }
        .btn-icon.main { background: var(--accent); color: #000; border: none; }

        .config-panel { flex-grow: 1; border-radius: 32px; overflow-y: auto; scrollbar-width: none; padding: 20px 25px; }
        .setting-item { margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid #111; }
        .setting-item.compact { margin-bottom: 8px; padding-bottom: 4px; border-bottom: none; }
        
        .setting-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2px; }
        .setting-label-text { font-size: 10px; color: var(--text-dim); letter-spacing: 1.5px; text-transform: uppercase; font-weight: 900; }
        .setting-value-text { font-size: 18px; color: var(--text-main); }
        
        .video-container { width: 100%; aspect-ratio: 16/9; border-radius: 24px; overflow: hidden; background: #000; border: 1px solid var(--border); position: relative; flex-shrink: 0; }
        #player { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .video-controls-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 32px; padding: 25px; flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; }

        .url-group { display: flex; gap: 8px; width: 100%; box-sizing: border-box; margin-bottom: 5px; }
        input[type="range"] { width: 100%; height: 6px; appearance: none; background: #222; border-radius: 3px; outline: none; margin: 8px 0; }
        input[type="range"]::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px; background: #fff; border-radius: 50%; border: 3px solid #000; cursor: pointer; }
        input[type="text"] { background: #000; border: 1px solid var(--border); border-radius: 10px; color: #fff; padding: 8px 12px; font-size: 11px; outline: none; flex: 1; min-width: 0; }
        .add-mini-btn { background: #222; color: #fff; border: none; border-radius: 10px; padding: 0 15px; font-size: 10px; font-weight: bold; cursor: pointer; white-space: nowrap; }

        .list-item { font-size: 11px; padding: 10px; color: #aaa; cursor: move; border-radius: 16px; margin-bottom: 8px; background: #111; border: 1px solid #222; display: flex; align-items: center; gap: 10px; text-decoration: none; }
        .list-item.dragging { opacity: 0.5; }
        .list-item.active { background: #fff; color: #000; }
        .item-text { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex: 1; font-weight: bold; }
        
        textarea { width: 100%; height: 100%; background: transparent; border: none; color: #ccc; resize: none; font-size: 15px; outline: none; line-height: 1.6; font-family: 'Share Tech Mono', monospace; }
        
        .todo-input-group { display: flex; gap: 8px; width: 100%; box-sizing: border-box; }
        .todo-list { margin-top: 15px; overflow-y: auto; scrollbar-width: none; }

        .todo-item { display: flex; align-items: center; gap: 12px; padding: 10px 15px; margin-bottom: 8px; background: #111; border: 1px solid #222; border-radius: 16px; font-size: 13px; width: 100%; box-sizing: border-box; transition: 0.3s; cursor: move; }
        .todo-item.dragging { opacity: 0.5; }
        .todo-item.done { opacity: 0.4; text-decoration: line-through; color: var(--text-dim); }
        .custom-checkbox { width: 18px; height: 18px; border: 2px solid #333; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; background: #000; flex-shrink: 0; }
        .custom-checkbox.checked { background: #fff; border-color: #fff; }
        .custom-checkbox.checked::after { content: '‚úì'; color: #000; font-size: 12px; font-weight: bold; }

        .switch { position: relative; display: inline-block; width: 36px; height: 18px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider-round { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #222; transition: .3s; border-radius: 34px; }
        .slider-round:before { position: absolute; content: ""; height: 12px; width: 12px; left: 3px; bottom: 3px; background-color: #555; transition: .3s; border-radius: 50%; }
        input:checked + .slider-round { background-color: #fff; }
        input:checked + .slider-round:before { transform: translateX(18px); background-color: #000; }
        
        details { background: #111; border-radius: 12px; padding: 5px 12px; margin-top: 5px; border: 1px solid var(--border); }
        summary { cursor: pointer; font-size: 13px; color: var(--text-main); padding: 8px 0; outline: none; list-style: none; }
        .sound-opt { padding: 10px 8px; border-bottom: 1px solid #222; cursor: pointer; color: var(--text-dim); font-size: 12px; }
        .credit-footer { text-align: center; color: #444; font-size: 9px; text-transform: uppercase; margin-bottom: 20px; line-height: 1.8; }
    </style>
</head>
<body>

<div class="main-layout">
    <div class="left-side">
        <div class="panel clock-card">
            <div id="clockDate" class="clock-date pixel-font"></div>
            <div id="clockTime" class="clock-time pixel-font"></div>
        </div>
        <div class="panel" style="padding:0; border-radius:24px; aspect-ratio:16/9;">
            <div class="video-container"><div id="player"></div></div>
        </div>
        <div class="video-controls-panel">
            <div class="volume-box"><span class="label" style="margin:0">Vol</span><input type="range" id="ytVolSlider" min="0" max="100" value="50"></div>
            <div class="url-group">
                <input type="text" id="ytUrl" placeholder="YouTube URL..." onkeydown="if(event.key==='Enter') addNewVideo()">
                <button class="add-mini-btn" onclick="addNewVideo()">ADD</button>
            </div>
            <span class="label">Playlist</span>
            <div class="video-list-container" id="videoList"></div>
        </div>
    </div>

    <div class="timer-side">
        <div class="panel">
            <span class="label" style="text-align:center">RokuDoro Focus</span>
            <div class="timer-container">
                <div class="timer-display pixel-font" id="disp">25:00</div>
                <div class="status-tag pixel-font" id="statusTag" style="text-align:center">Ready</div>
                <div class="set-display pixel-font" id="setLabel" style="text-align:center;">SET 1 / 4</div>
            </div>
            <div class="controls">
                <button class="btn-icon" onclick="resetT()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg></button>
                <button class="btn-icon main" id="startBtn"><svg id="playIcon" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"></path></svg><svg id="pauseIcon" viewBox="0 0 24 24" fill="currentColor" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg></button>
                <button class="btn-icon" onclick="skipStep()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m6 17 5-5-5-5"></path><path d="m13 17 5-5-5-5"></path></svg></button>
            </div>
        </div>

        <div class="panel config-panel">
            <span class="label">Settings</span>
            <div class="setting-item compact"><div class="setting-header"><span class="setting-label-text">‚ö° Auto Start</span><label class="switch"><input type="checkbox" id="autoStartToggle"><span class="slider-round"></span></label></div></div>
            <div class="setting-item"><div class="setting-header"><span class="setting-label-text">üéØ Focus</span><span id="fVal" class="setting-value-text pixel-font">25M</span></div><input type="range" id="fSlider" min="1" max="60" value="25"></div>
            <div class="setting-item"><div class="setting-header"><span class="setting-label-text">‚òï Break</span><span id="bVal" class="setting-value-text pixel-font">5M</span></div><input type="range" id="bSlider" min="1" max="30" value="5"></div>
            <div class="setting-item"><div class="setting-header"><span class="setting-label-text">üõå Long Break</span><span id="lbVal" class="setting-value-text pixel-font">15M</span></div><input type="range" id="lbSlider" min="5" max="60" value="15"></div>
            <div class="setting-item"><div class="setting-header"><span class="setting-label-text">üîÑ Sets</span><span id="sVal" class="setting-value-text pixel-font">4</span></div><input type="range" id="sSlider" min="1" max="10" value="4"></div>
            <div class="setting-item"><div class="setting-header"><span class="setting-label-text">üîä Alarm Volume</span><span id="alarmVolVal" class="setting-value-text pixel-font">50%</span></div><input type="range" id="alarmVolSlider" min="0" max="100" value="50"></div>
            <div class="setting-item"><span class="setting-label-text">üéµ Alarm Sound</span><details><summary id="currentAlarmName">Sound 01</summary><div id="alarmOptions"></div></details></div>
        </div>
    </div>

    <div class="right-side">
        <div class="panel notes-panel"><span class="label">Notes</span><textarea id="noteArea" placeholder="Focus on..."></textarea></div>
        <div class="panel todo-panel">
            <span class="label">ToDo List</span>
            <div class="todo-input-group">
                <input type="text" id="todoInput" placeholder="Add task..." onkeydown="if(event.key==='Enter') addTodo()">
                <button class="add-mini-btn" onclick="addTodo()">ADD</button>
            </div>
            <div class="todo-list" id="todoList"></div>
        </div>
    </div>
</div>

<footer class="credit-footer">
    <div>‚ÄªÂΩì„Çµ„Ç§„Éà„ÅÆ„Ç§„É©„Çπ„ÉàÂÖ®„Å¶„ÅØÂéü‰Ωú„ÄÅ‰ºÅÊ•≠„Åï„Åæ„Å®„ÅØ‰∏ÄÂàáÈñ¢‰øÇ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
    <div>Design: @016x001 / ALARM SOUND: Springin' Sound Stock / System: Gemini 2.0 Flash</div>
</footer>

<audio id="alarmAudio" preload="auto"></audio>

<script>
    // ÊôÇË®àÊõ¥Êñ∞
    function updateClock() {
        const now = new Date();
        const days = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
        document.getElementById('clockDate').innerText = `${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')} ${days[now.getDay()]}`;
        document.getElementById('clockTime').innerText = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;
    }
    setInterval(updateClock, 1000); updateClock();

    // ToDoÁÆ°ÁêÜ
    let todos = JSON.parse(localStorage.getItem('roku_todos')) || [];
    function renderTodos() {
        const list = document.getElementById('todoList');
        list.innerHTML = '';
        todos.forEach((t, i) => {
            const div = document.createElement('div');
            div.className = `todo-item ${t.done ? 'done' : ''}`;
            div.draggable = true;
            div.innerHTML = `<div class="custom-checkbox ${t.done ? 'checked' : ''}" onclick="toggleTodo(${i})"></div><span style="flex:1;">${t.text}</span><div style="color:#444; cursor:pointer; font-size:16px;" onclick="removeTodo(${i})">√ó</div>`;
            div.addEventListener('dragstart', (e) => { e.dataTransfer.setData('text/plain', i); div.classList.add('dragging'); });
            div.addEventListener('dragend', () => div.classList.remove('dragging'));
            div.addEventListener('dragover', (e) => e.preventDefault());
            div.addEventListener('drop', (e) => { e.preventDefault(); const fromIndex = parseInt(e.dataTransfer.getData('text/plain')); const toIndex = i; if (fromIndex !== toIndex) { const movedItem = todos.splice(fromIndex, 1)[0]; todos.splice(toIndex, 0, movedItem); renderTodos(); } });
            list.appendChild(div);
        });
        localStorage.setItem('roku_todos', JSON.stringify(todos));
    }
    function addTodo() { const input = document.getElementById('todoInput'); if(!input.value) return; todos.push({text: input.value, done: false}); input.value = ''; renderTodos(); }
    function toggleTodo(i) { todos[i].done = !todos[i].done; renderTodos(); }
    function removeTodo(i) { todos.splice(i, 1); renderTodos(); }
    renderTodos();

    // ÂàùÊúüË®≠ÂÆö„Å®Áä∂ÊÖãÁÆ°ÁêÜ
    const systemSounds = [{name:"Sound 01",url:"https://www.springin.org/wp-content/uploads/2022/06/%E6%B1%BA%E5%AE%9A2.mp3"},{name:"Sound 02",url:"https://www.springin.org/wp-content/uploads/2022/06/%E6%B1%BA%E5%AE%9A15.mp3"},{name:"Sound 03",url:"https://www.springin.org/wp-content/uploads/2022/06/%E6%AD%A3%E8%A7%A37.mp3"},{name:"Sound 04",url:"https://www.springin.org/wp-content/uploads/2022/06/%E5%87%BA%E9%A1%8C3.mp3"}];
    const STORAGE_KEY = 'rokudoro_config';
    let player, timerId = null, state = 'focus', currentSet = 1;
    let savedConfig = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
    let config = { focusM: savedConfig.focusM || 25, breakM: savedConfig.breakM || 5, longM: savedConfig.longM || 15, maxSets: savedConfig.maxSets || 4, autoStart: savedConfig.autoStart || false, alarmUrl: savedConfig.alarmUrl || systemSounds[0].url, alarmName: savedConfig.alarmName || systemSounds[0].name, alarmVol: savedConfig.alarmVol || 0.5, currentVid: savedConfig.currentVid || 'jfKfPfyJRdk', ytVol: savedConfig.ytVol || 50 };
    
    // „Çø„Ç§„Éû„ÉºË®àÁÆóÁî®
    let timeLeft = config.focusM * 60;
    let endTime = null; 

    let playlist = JSON.parse(localStorage.getItem('roku_playlist')) || [{ id: 'jfKfPfyJRdk', title: 'lofi hip hop radio üìö relax/study' }];

    function saveToStorage() { localStorage.setItem(STORAGE_KEY, JSON.stringify(config)); }
    
    // YouTube API
    let tag = document.createElement('script'); tag.src = "https://www.youtube.com/iframe_api"; document.head.appendChild(tag);
    function onYouTubeIframeAPIReady() { player = new YT.Player('player', { videoId: config.currentVid, playerVars: { 'autoplay': 0, 'playsinline': 1, 'modestbranding': 1 }, events: { 'onReady': (e) => { e.target.setVolume(config.ytVol); renderPlaylist(); } } }); }

    function renderPlaylist() {
        const container = document.getElementById('videoList'); container.innerHTML = '';
        playlist.forEach((vid, index) => {
            const div = document.createElement('div'); 
            div.className = 'list-item' + (vid.id === config.currentVid ? ' active' : '');
            div.draggable = true;
            div.innerHTML = `<span class="item-text" onclick="config.currentVid='${vid.id}'; saveToStorage(); player.loadVideoById('${vid.id}'); renderPlaylist();">${vid.title || vid.id}</span><div style="color:#444; font-size:16px; cursor:pointer;" onclick="removeVideo(${index})">√ó</div>`;
            div.addEventListener('dragstart', (e) => { e.dataTransfer.setData('text/vidx', index); div.classList.add('dragging'); });
            div.addEventListener('dragend', () => div.classList.remove('dragging'));
            div.addEventListener('dragover', (e) => e.preventDefault());
            div.addEventListener('drop', (e) => { e.preventDefault(); const fromIdx = parseInt(e.dataTransfer.getData('text/vidx')); const toIdx = index; if (!isNaN(fromIdx) && fromIdx !== toIdx) { const movedVid = playlist.splice(fromIdx, 1)[0]; playlist.splice(toIdx, 0, movedVid); localStorage.setItem('roku_playlist', JSON.stringify(playlist)); renderPlaylist(); } });
            container.appendChild(div);
        });
    }

    async function addNewVideo() {
        const url = document.getElementById('ytUrl').value;
        const vidId = url.match(/(?:v=|\/)([0-9A-Za-z_-]{11})/)?.[1];
        if (vidId) {
            let title = vidId; try { const res = await fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${vidId}`); const data = await res.json(); if(data.title) title = data.title; } catch(e){}
            playlist.push({ id: vidId, title: title }); 
            localStorage.setItem('roku_playlist', JSON.stringify(playlist));
            renderPlaylist(); document.getElementById('ytUrl').value = ''; 
        }
    }
    function removeVideo(i) { playlist.splice(i, 1); localStorage.setItem('roku_playlist', JSON.stringify(playlist)); renderPlaylist(); }

    // „Éù„É¢„Éâ„Éº„É≠„Éª„Éï„Çß„Éº„Ç∫ÁÆ°ÁêÜ
    function moveNextPhase(playSound = true) {
        if(playSound) { const a = document.getElementById('alarmAudio'); a.src = config.alarmUrl; a.volume = config.alarmVol; a.play(); }
        if(state === 'focus') { if(currentSet >= config.maxSets) { state = 'longBreak'; timeLeft = config.longM * 60; } else { state = 'break'; timeLeft = config.breakM * 60; } }
        else { if(state === 'longBreak') currentSet = 1; else currentSet++; state = 'focus'; timeLeft = config.focusM * 60; }
        updDisp(); if(config.autoStart) startTimer(); else updateIcons(false);
    }

    // „Åö„Çå„Å´„Åè„ÅÑ„Çø„Ç§„Éû„Éº (Áµ∂ÂØæÊôÇÈñì„Å®„ÅÆÂ∑ÆÂàÜ„ÇíË®àÁÆó)
    function startTimer() {
        updateIcons(true);
        endTime = Date.now() + (timeLeft * 1000);
        timerId = setInterval(() => {
            const now = Date.now();
            const diff = Math.round((endTime - now) / 1000);
            if(diff > 0) {
                timeLeft = diff;
                updDisp();
            } else {
                clearInterval(timerId);
                timerId = null;
                timeLeft = 0;
                updDisp();
                moveNextPhase(true);
            }
        }, 200);
    }

    function resetT() { clearInterval(timerId); timerId = null; state = 'focus'; currentSet = 1; timeLeft = config.focusM * 60; updDisp(); updateIcons(false); }
    function skipStep() { clearInterval(timerId); timerId = null; moveNextPhase(false); }
    function updateIcons(run) { document.getElementById('playIcon').style.display = run ? 'none' : 'block'; document.getElementById('pauseIcon').style.display = run ? 'block' : 'none'; }
    
    function updDisp() {
        const m = Math.floor(Math.max(0, timeLeft) / 60), s = Math.max(0, timeLeft) % 60;
        const timeStr = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        document.getElementById('disp').innerText = timeStr;
        document.getElementById('statusTag').innerText = state.toUpperCase();
        document.getElementById('setLabel').innerText = `SET ${currentSet} / ${config.maxSets}`;
        document.title = `${timeStr} - RokuDoro`;
    }

    // „Ç¢„É©„Éº„É†Èü≥Ë®≠ÂÆö
    const alarmContainer = document.getElementById('alarmOptions');
    systemSounds.forEach(s => {
        const div = document.createElement('div'); div.className = 'sound-opt'; div.innerText = s.name;
        div.onclick = (e) => {
            config.alarmUrl = s.url; config.alarmName = s.name; saveToStorage();
            document.getElementById('currentAlarmName').innerText = s.name;
            const a = document.getElementById('alarmAudio'); a.src = s.url; a.volume = config.alarmVol; a.play();
            e.stopPropagation();
        };
        alarmContainer.appendChild(div);
    });

    // UIÂàùÊúüÂåñ„Å®„Ç§„Éô„É≥„Éà
    function initUI() {
        document.getElementById('fSlider').oninput = e => { config.focusM = e.target.value; document.getElementById('fVal').innerText = e.target.value+'M'; saveToStorage(); if(state==='focus') resetT(); };
        document.getElementById('bSlider').oninput = e => { config.breakM = e.target.value; document.getElementById('bVal').innerText = e.target.value+'M'; saveToStorage(); };
        document.getElementById('lbSlider').oninput = e => { config.longM = e.target.value; document.getElementById('lbVal').innerText = e.target.value+'M'; saveToStorage(); };
        document.getElementById('sSlider').oninput = e => { config.maxSets = e.target.value; document.getElementById('sVal').innerText = e.target.value; saveToStorage(); updDisp(); };
        document.getElementById('autoStartToggle').onchange = e => { config.autoStart = e.target.checked; saveToStorage(); };
        document.getElementById('alarmVolSlider').oninput = e => { config.alarmVol = e.target.value / 100; document.getElementById('alarmVolVal').innerText = e.target.value + '%'; saveToStorage(); };
        document.getElementById('ytVolSlider').oninput = e => { config.ytVol = e.target.value; if(player) player.setVolume(e.target.value); saveToStorage(); };
        
        document.getElementById('fSlider').value = config.focusM; document.getElementById('fVal').innerText = config.focusM + 'M';
        document.getElementById('bSlider').value = config.breakM; document.getElementById('bVal').innerText = config.breakM + 'M';
        document.getElementById('lbSlider').value = config.longM; document.getElementById('lbVal').innerText = config.longM + 'M';
        document.getElementById('sSlider').value = config.maxSets; document.getElementById('sVal').innerText = config.maxSets;
        document.getElementById('autoStartToggle').checked = config.autoStart; document.getElementById('alarmVolSlider').value = config.alarmVol * 100;
        document.getElementById('alarmVolVal').innerText = (config.alarmVol * 100) + '%';
        document.getElementById('ytVolSlider').value = config.ytVol;
        document.getElementById('currentAlarmName').innerText = config.alarmName;
        updDisp();
    }
    
    document.getElementById('startBtn').onclick = () => timerId ? (clearInterval(timerId), timerId=null, updateIcons(false)) : startTimer();
    const note = document.getElementById('noteArea'); note.value = localStorage.getItem('roku_note') || ''; note.oninput = () => localStorage.setItem('roku_note', note.value);

    initUI();
</script>
</body>
</html>